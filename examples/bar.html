<html>
	<head>
	  <title>Backbone.d3 - Bar charts</title>

	  <link rel="stylesheet" href="style.css" type="text/css" />
    <script src="scripts/jquery.js" type='text/javascript'> </script>
    <script src="scripts/underscore-min.js" type="text/javascript"> </script>
    <script src="scripts/backbone.js" type="text/javascript"> </script>
    <script src="scripts/d3.min.js" type="text/javascript"> </script>
    <script src="scripts/d3.layout.min.js" type="text/javascript"> </script>
    <script src="../backbone-d3.js" type="text/javascript"> </script>

    <script type="text/javascript">
      $(function() {
        var DataPoint = Backbone.Model.extend({
          initialize: function(point) {
            this.set({
              id: point.id,
              x: point.x,
              y: point.y
            });
          }
        });

        var DataSeries = Backbone.d3.PlotCollection.extend({
          model : DataPoint,
          url : "bardata.json",
          plotdata: function(){
            var data = [];
            this.forEach(function(datapoint) {
                data.push(datapoint.get('y'));
              }
            )
            return data;
          },
          fetch: function(){
            // No op
            console.log('fetching is a no op in this example');
          }
        });

        var series = new DataSeries();

        var plot = new Backbone.d3.PlotView(series);
        series.reset([
          new DataPoint({x:1, y:6, id:1}),
          new DataPoint({x:2, y:4, id:2}),
          new DataPoint({x:3, y:2, id:3}),
          new DataPoint({x:4, y:4, id:4}),
          new DataPoint({x:5, y:6, id:5})
        ]);
        // evolve the dataset
        _.each(_.range(1,6), function(i, ii, l) {
          setTimeout(function() {
            console.log(plot.collection.toJSON());
    				console.log(plot.collection.length);
    				m = plot.collection.get(i);
    				console.log(m);
    				m.set({y:2*i});
    				console.log(m);
          }, i * 1000);
        })
      });

    </script>
  </head>
  <body>
    <div id="content">
      <h1>Bar charts</h1>
      <p>Backbone-d3 currently supports two classes of bar chart; static and
        scrolling. They only differ in how they behave when the collection is
        updated. Static bar charts will update in place and are good for when
        x-axis data is fixed. Scrolling bar charts are good for time series
        data - new data will appear on the right hand side and old will
        "drop-off" on the left.</p>
      <div id="plot"></div>
    </div>
  </body>
</html>
